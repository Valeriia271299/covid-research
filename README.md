# covid-research
prediction of covid dynamics
Проблемой короновируса COVID-19 буквально сейчас заняты многие ученые по всему миру. В стороне не осталось и комьюнити Data scientist-ов, которые пытаются не просто предсказать развитие пандемии, а помочь определить наиболее значимые факторы, влияющие на распространение заразы. Например на небезызвестном Kaggle.

В небольшом исследовании были использованы ежедневно обновляемые данные из репозитория, а конкретно time-series-19-covid-combined.csv. Для получения согласования результатов модели с выводами, написанными в ноутбуке, прилагаю в репозитории конкретные данные, на основе которых был осуществлен финальный прогон моделей.

Часть 1

Как и в любой работе с данными, для начала был проведен EAD (для полного ознакомление с ним предлагаю попробовать запустить ноутбук самостоятельно: так можно будет увидеть даже карту с распространением пандемии). В рамках EAD были исследованы границы исследуемого периода, количество заболевших, погибших, выздоровивших, визуализирован рост количества стран, подтвердивших случаи заражения. Примерно до середины февраля общее количество стран со случаями коронавируса оставалось на уровне около 25, но с середины февраля наблюдается резкий и большой скачок, такой, что уже через месяц колчичество стран превзошло отметку в 170. Были визуализированы мировые тренды по числу заболевших | погибших | выздоровивших и построены графики, которые отражают летальность от вируса в разных странах или на разных континентах. Динамика мировых трендов похожа: до середины марта количество заболевеших, умерших и выздоровивших растёт умеренно медленно, а середины марта эти числа начинают расти очень быстро наиболее ярко этот тренд проявляется с количеством заболевших (за месяц число растёт в 5 раз от 0,5 млн до 2,5 млн). Помимо различных визуализаций и анализа ситуации в мире в ноутбуке можно найти сравнение распространения пандемии в России со всем миром. В целом тренды похожи, однако в России ситуация начинает значительно и резко ухудшаться в конце марта - начале апреля, а в мире - с середины марта и более плавно. Более того, в России очень мало смертей по сравнению с мировой статистикой. Топ-10 лидеров по распространению ковида в мае 2020 года: США, Италия, Испания, Франция, Германия, Великобритания, Турция, Иран, Хубей (провинция в Китае), Россия. В проведённом EAD кроме уже озвученных фактов можно найти различные сравнения и других показателей и, соответственно, небольшие выводы по ним. 

Ключевой вывод по первой части исследования: если с момента появления вируса в Китае число заболевших росло преимущественно в нём, а другие страны были в стороне и не понимали опасность всей ситуации, то сейчас ситуация, можно сказать, изменилась. Есть страны, где число заболевших и умерших превысило Китай, причём за очень короткое время, потому что страны либо не хотели вводить карантин, либо были не подготовлены. Китай же выходит на "плато". Очаги заражения распространяются по районам примерно в одно и то же время - такой вывод можно сделать, глядя на Европу и время, когда в европейских странах начался стремительный тренд заражённых. Стоит отметить, что в России возрастающий тренд начинает увеличиваться позже, чем в европейских странах, что даёт право сделать предположение, что наша страна находится только на подходе к пику заражения коронавирусом. Что касается количества умерших от вируса, то оно больше в странах, где продолжительность жизни больше, чем средняя, и в тех, кто был не готов к пандемии по каким-либо причинам (в случае США, как уже говорилось, частное зравоохранение, в случае бедных стран - нехватка денег не оборудование и качественную медицину). Если говорить о самих показателях как о тех, что будут прогнозироваться во 2 части исследования, то почти со 100 % уверенностью можно сказать, что придётся бороться с нестационарностью рядов ввиду характерного тренда.

Часть 2

Во второй части работы были построены несколько моделей и спрогнозирован временной ряд для такого показателя как летальности от вируса. Летальность рассчитана по формуле:

$$ CFR = \frac{Deaths}{Confirmed} $$

Для каждого типа модели реализованы по 3 прогноза для России, Италии и Испании. Россия была выбрана, потому что интересна статистика и ситуация, в стране, где мы живём. Италия и Испания были выбраны, потому что за короткое время они успели догнать и даже перегнать число заболевших в Китае, где вирус появился, более того, в этих странах высокая продолжительность жизни, а известно, что вероятность умереть от коронавируса больше в пожилом возрасте, а в задаче как раз и анализируется летальность. США, лидеры по числу заболевших, не были выбраны, потому что, на мой взгляд, было бы сложнее бороться с трендом в их случае.

Метрика качества RMSE.

В ноутбке представлены результаты следующих моделей для прогнозирования летальности в выбранных странах: mean constant model, linear trend model, exponential smoothing, MA - Moving average, AR - Autoregressive model, ARMA, ARIMA (Auto Regressive Integrated Moving Average), SARIMA, Linear Regression Model, xgboost (реализована не полностью). Также для прогнозирования врменного ряда была использована библиотке Prophet.

По второй части этого небольшого исследования можно сделать следующие выводы: для всех стран хорошо работает экспоненциальное сглаживание, однако затем результаты рознятся. Для России хорошо работают модели АР, МА, АРИМА. Для Италии те, которые связаны с трендом (модель с линейным трендом, модели сглаживания). А для Испании, как и для России, модели АР, МА и АРИМА. Мне кажется, что возможно, сложилась такая ситуация, потому что в Италии тренд более ярко выражен, чем в России и Испании, поэтому и модели с трендом работают на данных этой страны лучше. Ещё одну вещь, которую хотелось бы отметить в выводе по второй части - это необходимость в моделях АРИМА бороться с нестационарностью рядов, которая была общей для всех трёх стран.

Выводы по covid research

Несмотря на внешнюю схожесть развития болезни по миру при анализе трёх стран в отдельности  выясняется, что им подходят разные модели, точнее, разные модели лучше работают. Конечно, визуализация и корреляции помогают увидеть общие закономерности, но, чтобы более качественно спрогнозировать ряды, необходимо внимательно анализировать одну страну, пробуя разные модели и, главное - гиперпараметры. Интересной особенностью covid данных была нестационарность, вызванная, скороее всего, характерным трендом. С ней нужно было бороться для адекватного прогнозирования рядов. Что касается других моделей, то проблем с ними не возникло.







